<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Houston Web Design</title>
  <link rel="stylesheet" href="styles.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Funnel+Display:wght@200;400;600;800&display=swap" rel="stylesheet">

  <style>
    html, body { margin:0; padding:0; background:#000; }
    body{ overflow-x:hidden; font-family: 'Funnel Display', sans-serif; color:#fff; }

    /* Background glow */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      background:
        radial-gradient(circle at top left, rgba(84,243,164,0.22) 0, transparent 38vw),
        radial-gradient(circle at top right, rgba(84,243,164,0.22) 0, transparent 38vw);
      opacity:0.9;
      z-index:0;
    }

    .wrap{
      position:relative;
      z-index:1;
      width:min(85vw, 92vw);
      margin:0 auto;
    }

    /* HERO */
    .hero{
      height:100vh;
      display:flex;
      align-items:center;
      position:relative;
      z-index:1;
    }

    .hero-grid{
      display: grid;
      grid-template-columns: 1.4fr 0.6fr;
      gap: 1.25rem;
      align-items: start;
      width: 100%;
    }


    .kicker{
      font-size: 11px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.6);
      margin-bottom: 1rem;
    }

    .title{
      font-size: clamp(3.1rem, 5.6vw, 8rem);
      line-height: 0.88;
      font-weight: 600;
      letter-spacing: -0.02em;
      margin:0;
    }
    .accent{ color:#54f3a4; }

    .lede{
      margin-top: 1.3rem;
      font-size: clamp(1.2rem, 1.9vw, 1.65rem);
      font-weight: 200;
      color: rgba(255,255,255,0.78);
      line-height: 1.25;
      max-width: 66ch;
    }

    .proof{
      margin-top: 1.15rem;
      font-size: 1rem;
      color: rgba(255,255,255,0.65);
      line-height: 1.35;
    }

    .panel{
      border: 1px solid rgba(255,255,255,0.16);
      border-radius: 18px;
      background: rgba(255,255,255,0.03);
      padding: 1.25rem;
      display:grid;
      gap: 0.85rem;
      align-content:start;
    }

    .panel-title{
      font-size: 1rem;
      letter-spacing: 0.10em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.6);
      margin:0;
    }
    .availability{
      display: flex;
      align-items: center;
      gap: .5rem;
      margin: .85rem 0 1.25rem;
      font-size: .85rem;
      color: rgba(255,255,255,0.72);
    }

    .availability .dot{
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #54f3a4;
      box-shadow: 0 0 12px rgba(84,243,164,.55);
    }

    /* Button */
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:space-between;
      gap: 1rem;
      width: 300px;
      padding: 0 1.2rem;
      height: 64px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.9);
      color:#fff;
      background: transparent;
      cursor:pointer;
      text-decoration:none;
      font-size: 1.15rem;
      font-weight: 600;
      position:relative;
      overflow:hidden;
      isolation:isolate;
    }

    .btn::before{
      content:"";
      position:absolute;
      width: 300px;
      height: 300px;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%) scale(0);
      border-radius: 999px;
      background:#fff;
      z-index:-1;
      transition: transform 0.65s ease;
    }
    .btn:hover::before{ transform: translate(-50%,-50%) scale(1); }
    .btn:hover{ color:#000; }

    .arrow{
      width: 38px;
      height: 38px;
      border-radius: 999px;
      background:#54f3a4;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      flex: 0 0 auto;
      transition: transform .25s ease;
    }
    .btn:hover .arrow{
      transform: translate(2px, -2px);
      background: white;
    }
    .arrow svg{ width:16px; height:16px; stroke:#ffffff; }
    .btn:hover .arrow svg{ stroke:#000000; }

    /* ===== OVERLAY SHEET =====
       This is the magic:
       - It sits on top of the hero in layout (margin-top:-100vh)
       - But starts visually below the fold (transform: translateY(100vh))
       - After it slides to 0, it scrolls normally forever
    */
    .sheet{
      position:relative;
      z-index:2;
      margin-top: -100vh;
      transform: translateY(100vh);
      will-change: transform;
      background:#000;
      border-top: 1px solid rgba(255,255,255,0.12);
      box-shadow: 0 -40px 120px rgba(0,0,0,0.65);
    }

    .divider{
      width:100%;
      border:0;
      border-top:1px solid rgba(255,255,255,0.14);
      margin:0;
    }

    /*.section{ padding: clamp(3rem, 7vw, 6rem) 0; }*/

    .strip{ padding: 2.5rem 0 1.5rem; }
    .strip-grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
    }
    .chip{
      border: 1px solid rgba(255,255,255,0.14);
      border-radius: 16px;
      padding: 1.25rem;
      background: rgba(255,255,255,0.02);
      
    }
    .chip .k{
      font-size: 0.85rem;
      letter-spacing: 0.10em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.6);
      margin-bottom: 0.55rem;
    }
    .chip .v{
      font-size: clamp(1.5rem, 2.2vw, 2.4rem);
      line-height: 1;
      font-weight: 600;
    }

    .h2{
      font-size: clamp(3.2rem, 6.2vw, 6.8rem);
      line-height: 0.95;
      font-weight: 600;
      margin: 0 0 1rem 0;
      letter-spacing: -0.01em;
      padding: 0 2rem;
    }

    .copy{
      font-size: clamp(1.1rem, 1.55vw, 1.4rem);
      font-weight: 200;
      color: rgba(255,255,255,0.78);
      line-height: 1.35;
      max-width: 72ch;
    }


    @media (max-width: 980px){
      .hero-grid{ grid-template-columns:1fr; }
      .strip-grid{ grid-template-columns:1fr; }
      .card-grid{ grid-template-columns:1fr; }
      .hero{ padding: 8vh 0; height:auto; min-height:100vh; }
      .sheet{ margin-top: 0; transform: translateY(0); } /* mobile fallback */
    }
    /* MOBILE FIX — remove hero scrollbar */
@media (max-width: 980px) {
  .hero {
    height: auto;          /* remove fixed height */
    min-height: 100svh;    /* modern mobile viewport */
    overflow: hidden;      /* no inner scroll */
    margin-top: 2.5rem;
  }

  body {
    overflow-x: hidden;
  }
}
  </style>
    <style>

    canvas#vapor{
      position:fixed; inset:0;
      width:100%; height:100%;
      z-index:0;
      display:block;
      pointer-events:none;
    }

    /* ✅ very light vignette (not a dark “screen overlay”) */
    .overlay{
      position:fixed;
      inset:0;
      z-index:1;
      pointer-events:none;
      background:
        radial-gradient(
          90% 90% at 50% 45%,
          rgba(0,0,0,0) 0%,
          rgba(0,0,0,.09) 72%,
          rgba(0,0,0,.22) 100%
        );
    }
    .proof-divider{
  width:100%;
  height: 1px;
  margin: 1.25rem 0 0.75rem;
  background: linear-gradient(
    to right,
    rgba(255,255,255,0.35),
    rgba(255,255,255,0.05)
  );
}

.chip img{
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
}
.strip-grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
}

/* Force placement on row 2 */
.chip-4{ grid-column: 1 / 2; }   /* col 1 */
.chip-5{ grid-column: 2 / 4; }   /* col 2-3 (2/3 width) */

/* logo sizing */

.chip-5{
  display: flex;
  align-items: center;
  justify-content: stretch;
  overflow: hidden; /* IMPORTANT: clips the image */
  max-height: 300px;
}
.stats {
  padding: 6rem 2rem;
  background: radial-gradient(circle at top, #0c0c0c, #000);
}

.stats-grid {
  max-width: 1100px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 3rem;
}

.stat {
  text-align: center;
}

.stat-top{
  display: inline-flex;
  align-items: baseline;
  gap: .12em;
  line-height: 1;
}

.stat-number {
  font-size: clamp(3rem, 6vw, 4.5rem);
  font-weight: 800;
  letter-spacing: -0.03em;
  color: #10ffa3;
  text-shadow: 0 0 25px rgba(16,255,163,0.15);
}
.stat-plus {
  font-size: 2.72em;      /* ⬆ bigger, still secondary */
  font-weight: 700;
  color: #10ffa3;
  transform: translateY(-0.06em);
}

.stat-range {
  color: #7fdcff;
  text-shadow: 0 0 20px rgba(127,220,255,0.15);
}

.stat-label {
  margin-top: 0.75rem;
  font-size: 0.95rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  opacity: 0.7;
}
  </style>
</head>

<body>
<canvas id="vapor"></canvas>
  <div class="overlay"></div>
<!-- Navbar -->
  <nav class="navbar">
    <div class="navbar__container">
      <div class="navbar__left">
        <a href="/" id="navbar__logo" class="logo">
          <img class="logo1" src="images/logo2.png" alt="Logo" />
        </a>
      </div>

      <div class="navbar__right">
        <a href="mailto:christian@mcvdesign.com" class="navbar__email">
          christian@mcvdesign.com
        </a>
        <a href="inquiry.html">
          <button class="navbar__inquiry">
            Send Inquiry
            <span class="inquiry-arrow">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                   stroke-linecap="round" stroke-linejoin="round" class="arrow-icon">
                <path d="M7 17L17 7" />
                <path d="M7 7h10v10" />
              </svg>
            </span>
          </button>
        </a>
        <div class="navbar__contact"><span></span></div>
      </div>

      <div id="mobile-menu" class="navbar__toggle">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </div>
  </nav>

  <!--DROPDOWN MENU-->
  <div class="dropdown-menu" id="navDropdown">
    <div class="dropdown-video-bg">
      <video autoplay muted loop playsinline>
        <source src="https://vmqlladebjzniwevemsg.supabase.co/storage/v1/object/public/videos/donut9.mp4" type="video/mp4" />
      </video>
    </div>

    <div class="dropdown-content">
      <button class="close-menu" id="closeMenu">×</button>
        <ul class="dropdown-links">
          <li class="dropdown-mask">
            <a href="/index.html" class="dropdown-link">Home</a>
          </li>
          <li class="dropdown-mask">
            <a href="/services.html" class="dropdown-link">Services</a>
          </li>
          <li class="dropdown-mask">
            <a href="/work.html" class="dropdown-link">Work</a>
          </li>
          <li class="dropdown-mask">
            <a href="/inquiry.html" class="dropdown-link">Contact</a>
          </li>
        </ul>


      <div class="dropdown-email">
        <button class="navbar__email">
          christian@mcvdesign.com
        </button>
      </div>

      <div class="dropdown-copyright"><h2>Copyright © 2025</h2></div>
      <div class="social-button-container">
        <button class="bottom-btn">LinkedIn</button>
        <button class="bottom-btn">Instagram</button>
        <button class="bottom-btn">Dribble</button>
        <button class="bottom-btn">Behance</button>
      </div>
    </div>
  </div>

  

  <!-- HERO -->
  <section class="hero" id="hero">
    <div class="wrap">
      <div class="hero-grid">
        <div>
          <!--<div class="kicker">MCVDesign • Houston, Texas</div>-->
          <h1 class="title"><span class="accent">Houston Web Design</span><br>That Gets More Leads for Your Business.</h1>
          <div class="proof-divider"></div>
          <p class="lede">
            We design and build custom websites for Houston businesses that turn clarity, performance, and structure into a reliable lead engine.
          </p>
          <!--
          <p class="proof">
            <strong style="color:rgba(255,255,255,0.88)">Based in Houston, TX.</strong>
            Serving Cypress, Katy, The Heights, Downtown, Sugar Land, The Woodlands, and Pearland.
          </p>-->
        </div>

        <aside class="panel">
          <p class="panel-title">Start Here</p>
          <p style="margin:0; color:rgba(255,255,255,0.78); font-weight:200; line-height:1.35;">
            Tell us what you’re building and we’ll reply with next steps, timeline, and a clear plan.
          </p>

          <div class="availability">
            <span class="dot"></span>
            <span>2 project slots available this month</span>
          </div>

          <a class="btn" href="#">
            Start Your Project
            <span class="arrow" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M7 17L17 7"/><path d="M7 7h10v10"/>
              </svg>
            </span>
          </a>
        </aside>
      </div>
    </div>
  </section>

  <!-- OVERLAY SHEET (in normal flow, so it keeps scrolling) -->
  <section class="sheet" id="sheet">
    <hr class="divider"/>
    <div class="stats">
  <div class="stats-grid">

    <div class="stat">
      <div class="stat-top">
        <span class="stat-number">10</span><span class="stat-plus">+</span>
      </div>
      <div class="stat-label">Years of Experience</div>
    </div>

    <div class="stat">
      <div class="stat-top">
        <span class="stat-number">150</span><span class="stat-plus">+</span>
      </div>
      <div class="stat-label">Design Projects Completed</div>
    </div>

    <div class="stat">
      <div class="stat-top">
        <span class="stat-number stat-range">7–14</span>
      </div>
      <div class="stat-label">Average Project Turnaround</div>
    </div>

  </div>
</div>
<!-- STRIP 
    <section class="strip">
      <div class="wrap">
        <div class="strip-grid">
            <div class="chip"><div class="k">Years of Experience</div><div class="v">10+</div></div>
            <div class="chip"><div class="k">Design Projects Completed</div><div class="v">150+</div></div>
            <div class="chip"><div class="k">Built for</div><div class="v">Lead Generation</div></div>

          
            <div class="chip chip-4">
              <div class="k">Avg. Turnaround</div>
              <div class="v">7–14 days</div>
            </div>

         
            <div class="chip chip-5">
              <div class="k">
                <img src="images/stock2.jpg" alt="Unico website and lead generation work">
              </div>
            </div> 
          </div>
      </div>
    </section>-->

    <section class="section"> 
     
        <h2 class="h2">Design that defines your brand and drives real growth</h2>
        <!--<p class="copy">
          Houston is competitive, and your website has seconds to make an impression. Intentional design builds instant credibility and real business growth. We handle the design and structure, so you can focus on what you do best.
        </p>--></section>

        <section id="servicesBlock">
        <div class="services">
        <div class="services-container">
          <div class="services-card">
            <h3 class="card-title">Design</h3>
            <div class="card-text">Our design services combine aesthetics and functionality to create digital products.</div>
            <div class="card-text2">+ Branding<br>+ Website & E-commerce<br>+ Mobile & Web App<br>+ User Experience</div>
            <hr class="card-divider">
            <a href="inquiry.html">
              <button class="button-design">
                Learn More
                <span class="inquiry-arrow">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round" class="arrow-icon">
                    <path d="M7 17L17 7" />
                    <path d="M7 7h10v10" />
                  </svg>
                </span>
              </button></a>
          </div>

          <div class="services-card">
            <h3 class="card-title">Development</h3>
            <div class="card-text">Our development solutions merge innovation and efficiency to engineer digital solutions.</div>
            <div class="card-text2">+ Mobile & Web Apps<br>+ Web Development<br>+ Cross-Platform<br>+ Embedded Software</div>
            <hr class="card-divider">
            <a href="inquiry.html">
              <button class="button-design">
                Learn More
                <span class="inquiry-arrow">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round" class="arrow-icon">
                    <path d="M7 17L17 7" />
                    <path d="M7 7h10v10" />
                  </svg>
                </span>
              </button></a>
          </div>

          <div class="services-card">
            <h3 class="card-title">Growth</h3>
            <div class="card-text">Versatile solutions tailored to your unique requirements, providing support across diverse domains.</div>
            <div class="card-text2">+ Scoping<br>+ Consulting<br>+ Management<br>+ Support</div>
            <hr class="card-divider">
            <a href="inquiry.html">
              <button class="button-design">
                Learn More
                <span class="inquiry-arrow">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round" class="arrow-icon">
                    <path d="M7 17L17 7" />
                    <path d="M7 7h10v10" />
                  </svg>
                </span>
              </button></a>
          </div>

        </div>
     
      </section>

<section class="section"> <div class="wrap">
        <!-- add a bunch of content so you can feel the continuous scroll -->
        <div style="height:0vh"></div>
        <h2 class="h2">More content below</h2>
        <p class="copy">This keeps scrolling normally because the sheet is in document flow.</p>
        <div style="height:20vh"></div>
      </div>
    </div>
  </section>

  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    const hero  = document.querySelector("#hero");
    const sheet = document.querySelector("#sheet");

    // Desktop only (mobile fallback handled in CSS)
    if (!window.matchMedia("(max-width: 980px)").matches) {
      gsap.set(sheet, { y: window.innerHeight }); // matches the translateY(100vh) idea

      gsap.to(sheet, {
        y: 0,
        ease: "none",
        scrollTrigger: {
          trigger: hero,
          start: "top top",
          end: "+=70%",   // slide duration
          scrub: 0.9,
          pin: true,       // pins hero only during the slide
          pinSpacing: true,
          anticipatePin: 1
        }
      });

      // refresh on resize so y uses updated vh
      window.addEventListener("resize", () => ScrollTrigger.refresh());
    }
  </script>

<script>
  const canvas = document.getElementById("vapor");
  const ctx = canvas.getContext("2d", { alpha:true });

  // Offscreen buffer (simulation)
  const buf = document.createElement("canvas");
  const btx = buf.getContext("2d", { alpha:true });

  // ✅ Mobile normalization buffers
  const post = document.createElement("canvas");
  const ptx  = post.getContext("2d", { alpha:true });

  const melt = document.createElement("canvas");
  const mtx  = melt.getContext("2d", { alpha:true });

  // ✅ Optional dither (mobile only) to kill gradient banding rings
  const noise = document.createElement("canvas");
  const ntx   = noise.getContext("2d", { alpha:true });
  noise.width = 128;
  noise.height = 128;
  (function seedNoise(){
    const img = ntx.createImageData(noise.width, noise.height);
    for (let i=0;i<img.data.length;i+=4){
      const v = (Math.random() * 255) | 0;
      img.data[i+0] = v;
      img.data[i+1] = v;
      img.data[i+2] = v;
      img.data[i+3] = 255;
    }
    ntx.putImageData(img, 0, 0);
  })();

  // Mobile detection: width breakpoint OR coarse pointer devices
  const mqMobile = window.matchMedia("(max-width: 980px), (hover: none) and (pointer: coarse)");
  let isMobile = mqMobile.matches;
  mqMobile.addEventListener?.("change", (e)=>{ isMobile = e.matches; resize(); });

  const S = {
    w:0, h:0,
    dpr: Math.max(1, Math.min(2, window.devicePixelRatio || 1)),
    t:0,

    // slow drift
    speed: 0.0046,

    // ✅ Desktop baseline (UNCHANGED from your version)
    scale: 0.70,
    fade: 0.22,
    glow: 0.25,
    density: 0.66,

    amp: 0.16,
    drift: 0.16,
    band: 0.16,
    breakUp: 1.05,

    blurBase: 10,
    blurDetail: 4,
    blurGlow: 14,

    // ✅ Mobile: force same look everywhere by standardizing internal sim resolution
    // This sets the simulation's LONG SIDE to a constant pixel size across all phones.
    mobileSimLongSide: 980,   // try 900–1100; higher = smoother/heavier

    // ✅ Mobile: “melt” normalization (downsample → blur hard → upsample)
  mobileMeltDown: 0.70,     // don't go super low (0.32 is too mushy)
mobileMeltBlur: 12,       // moderate melt (not foggy)
mobileDetailAlpha: 0.20,  // keep detail but don’t bring back discs
mobileDitherAlpha: 0.006, // tiny — should NOT look grainy
    mx:0, my:0, px:0, py:0
  };

  function resize(){
    S.w = Math.floor(window.innerWidth);
    S.h = Math.floor(window.innerHeight);

    // Main canvas uses DPR for crisp UI layers
    canvas.width  = Math.floor(S.w * S.dpr);
    canvas.height = Math.floor(S.h * S.dpr);
    canvas.style.width  = S.w + "px";
    canvas.style.height = S.h + "px";
    ctx.setTransform(S.dpr,0,0,S.dpr,0,0);

    // ✅ SIM BUFFER SIZING
    if (!isMobile) {
      // Desktop: exactly your original behavior
      buf.width  = Math.floor(S.w * S.scale);
      buf.height = Math.floor(S.h * S.scale);
    } else {
      // Mobile: fixed internal “long side” sim resolution (consistent across devices)
      const longSide = Math.max(S.w, S.h);
      const k = S.mobileSimLongSide / longSide;  // scale factor to reach standard long side
      buf.width  = Math.max(2, Math.floor(S.w * k));
      buf.height = Math.max(2, Math.floor(S.h * k));
    }
    btx.setTransform(1,0,0,1,0,0);

    // post matches sim size
    post.width  = buf.width;
    post.height = buf.height;
    ptx.setTransform(1,0,0,1,0,0);

    // melt is smaller (mobile-only, but we allocate regardless)
    const md = isMobile ? S.mobileMeltDown : 0.60;
    melt.width  = Math.max(2, Math.floor(buf.width  * md));
    melt.height = Math.max(2, Math.floor(buf.height * md));
    mtx.setTransform(1,0,0,1,0,0);

    // store for step()
    S.bw = buf.width;
    S.bh = buf.height;

    // smoothing hints (browser-dependent, but keep them on)
    ctx.imageSmoothingEnabled = true;
    ctx.imageSmoothingQuality = "high";
    btx.imageSmoothingEnabled = true;
    btx.imageSmoothingQuality = "high";
    ptx.imageSmoothingEnabled = true;
    ptx.imageSmoothingQuality = "high";
    mtx.imageSmoothingEnabled = true;
    mtx.imageSmoothingQuality = "high";

    // clear
    btx.fillStyle = "rgba(0,0,0,1)";
    btx.fillRect(0,0,S.bw,S.bh);
    ptx.clearRect(0,0,post.width,post.height);
    mtx.clearRect(0,0,melt.width,melt.height);
    ctx.clearRect(0,0,S.w,S.h);
  }
  window.addEventListener("resize", resize, { passive:true });
  resize();

  window.addEventListener("pointermove", (e)=>{
    S.mx = (e.clientX / S.w) * 2 - 1;
    S.my = (e.clientY / S.h) * 2 - 1;
  }, { passive:true });

  const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));

  function n2(x,y){
    return Math.sin(x*1.7 + Math.cos(y*1.3)) * Math.cos(y*1.5 + Math.sin(x*1.1));
  }

  function puff(x,y,r, colA, colB, a){
    const g = btx.createRadialGradient(x,y,0, x,y,r);
    g.addColorStop(0.00, colA.replace("{a}", (0.52*a).toFixed(4)));
    g.addColorStop(0.38, colB.replace("{a}", (0.46*a).toFixed(4)));
    g.addColorStop(0.78, colA.replace("{a}", (0.15*a).toFixed(4)));
    g.addColorStop(1.00, colA.replace("{a}", "0"));
    btx.fillStyle = g;
    btx.beginPath();
    btx.arc(x,y,r,0,Math.PI*2);
    btx.fill();
  }

  function ribbonY(u, yBase, amp, phase){
    const t = S.t;
    const f1 = Math.sin(t*0.95 + u*6.2 + phase);
    const f2 = Math.sin(t*0.55 + u*13.0 - phase*0.7);
    const f3 = Math.sin(t*1.35 + u*3.2);
    const wave = f1*0.55 + f2*0.30 + f3*0.15;
    return yBase + wave * amp;
  }

  function step(){
    S.t += S.speed;

    S.px += (S.mx - S.px) * 0.03;
    S.py += (S.my - S.py) * 0.03;

    const W = S.bw;
    const H = S.bh;

    // fade buffer (trails)
    btx.globalCompositeOperation = "source-over";
    btx.fillStyle = `rgba(0,0,0,${S.fade})`;
    btx.fillRect(0,0,W,H);

    // draw vapor
    btx.globalCompositeOperation = "lighter";

    const layers = [
      { y: 0.33, amp: S.amp*0.85, phase: 0.0,  drift:  0.14, tint: 0.0,  strength: 0.92 },
      { y: 0.56, amp: S.amp*1.05, phase: 1.4,  drift: -0.10, tint: 1.3,  strength: 0.80 },
      { y: 0.74, amp: S.amp*0.95, phase: 2.25, drift:  0.08, tint: 2.2,  strength: 0.70 }
    ];

    for(const L of layers){
      const sweep  = (Math.sin(S.t*0.55 + L.phase) * 0.5 + 0.5);
      const xShift = (sweep * 0.7 + 0.15) * W * L.drift;

      const steps = 120;

      for(let i=0;i<=steps;i++){
        const u = i/steps;

        const TAIL = 520;
        const x = u*(W + TAIL*2) - TAIL + xShift + S.px*16;
        const yC = ribbonY(u, H*L.y, H*L.amp, L.phase) + S.py*12;

        const band = (S.band * H);

        const tt = S.t*0.9 + L.phase + u*2.0;
        const wx = n2(tt*0.8, u*4.0 + L.phase);
        const wy = n2(u*3.0 - L.phase, tt*0.7);

        const jx = wx * band * 0.36 * S.breakUp;
        const jy = wy * band * 0.30 * S.breakUp;

        const c1 = (Math.sin(S.t*0.30 + L.tint + u*2.1)*0.5 + 0.5);
        const c2 = (Math.cos(S.t*0.24 - L.tint + u*1.7)*0.5 + 0.5);

        const A = `rgba(${Math.floor(84 + 22*c2)}, ${Math.floor(243 - 18*c1)}, ${Math.floor(164 + 34*c1)}, {a})`;
        const B = `rgba(${Math.floor(72 + 16*c1)}, ${Math.floor(155 + 120*c2)}, ${Math.floor(125 + 26*c2)}, {a})`;

        const end = 0.35 + 0.65 * (1 - Math.pow(Math.abs(u-0.5)*2, 2.2));

        const r1 = clamp(band * (1.18 + 0.35*Math.sin(tt)), 52, 220);
        const a1 = (0.010 + 0.010*c1) * S.density * L.strength * (0.40 + 0.60*end);
        puff(x, yC, r1, A, B, a1);

        const r2 = clamp(r1*0.40, 20, 88);
        const a2 = a1 * 0.78;
        puff(x + jx, yC + jy, r2, B, A, a2);

        const off = (wy * 0.5 + 0.5) * band * 0.90;
        puff(x - jx*0.55, yC + off*0.32, r2*0.78, A, B, a2*0.50);
        puff(x + jx*0.45, yC - off*0.30, r2*0.72, B, A, a2*0.46);
      }

      const hx = W*0.5 + Math.sin(S.t*0.28 + L.phase)*W*0.12 + S.px*10;
      const hy = H*L.y + Math.cos(S.t*0.26 - L.phase)*H*0.10 + S.py*8;
      puff(hx, hy, Math.hypot(W,H)*0.22, "rgba(84,243,164,{a})", "rgba(170,110,255,{a})", 0.009*S.density);
    }

    btx.globalCompositeOperation = "source-over";

    // ✅ Mobile normalization source:
    // Desktop: buf directly (your original look)
    // Mobile: melt pass -> post, then composite from post
    let src = buf;

    if (isMobile) {
      // Downsample + heavy blur into melt
      mtx.save();
      mtx.clearRect(0,0,melt.width,melt.height);
      mtx.filter = `blur(${S.mobileMeltBlur}px)`;
      mtx.globalAlpha = 1;
      mtx.drawImage(buf, 0, 0, W, H, 0, 0, melt.width, melt.height);
      mtx.restore();
      mtx.filter = "none";

      // Upsample back to post
      ptx.save();
      ptx.clearRect(0,0,post.width,post.height);
      ptx.globalAlpha = 1;
      ptx.drawImage(melt, 0, 0, melt.width, melt.height, 0, 0, post.width, post.height);
      ptx.restore();

      src = post;
    }

    // Final composite to main canvas
    ctx.globalCompositeOperation = "source-over";
    ctx.clearRect(0,0,S.w,S.h);

    // base pass
    ctx.save();
    ctx.filter = `blur(${S.blurBase}px)`;
    ctx.globalAlpha = 1;
    ctx.drawImage(src, 0, 0, W, H, 0, 0, S.w, S.h);
    ctx.restore();

    // detail pass (mobile softened)
    ctx.save();
    ctx.filter = `blur(${S.blurDetail}px)`;
    ctx.globalCompositeOperation = "lighter";
    ctx.globalAlpha = isMobile ? S.mobileDetailAlpha : 0.55;
    ctx.drawImage(src, 0, 0, W, H, 0, 0, S.w, S.h);
    ctx.restore();

    // glow pass
    ctx.save();
    ctx.filter = `blur(${S.blurGlow}px)`;
    ctx.globalCompositeOperation = "lighter";
    ctx.globalAlpha = S.glow;
    ctx.drawImage(src, 0, 0, W, H, 0, 0, S.w, S.h);
    ctx.restore();

    // ✅ Mobile-only dither overlay (breaks banding rings)
    if (isMobile && S.mobileDitherAlpha > 0) {
      ctx.save();
      ctx.globalCompositeOperation = "source-over";
      ctx.globalAlpha = S.mobileDitherAlpha;
      // tile noise across the whole canvas
      for (let y=0; y<S.h; y+=noise.height) {
        for (let x=0; x<S.w; x+=noise.width) {
          ctx.drawImage(noise, x, y);
        }
      }
      ctx.restore();
    }

    ctx.globalAlpha = 1;
    ctx.globalCompositeOperation = "source-over";
    ctx.filter = "none";
  }

  gsap.ticker.fps(60);
  gsap.ticker.add(step);

  // Reduced motion
  if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
    gsap.ticker.remove(step);
    for(let i=0;i<20;i++) step();
  }
</script>
  <script src="app.js"></script>
</body>
</html>