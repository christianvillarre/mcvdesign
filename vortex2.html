<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Abstract Gas / Gel Vapor (GSAP)</title>
  <style>
    :root{
      --bg:#000;
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.65);
      --stroke:rgba(255,255,255,.10);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      min-height:100vh;
      background:var(--bg);
      color:var(--text);
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      overflow:hidden;
    }
    canvas#gas{
      position:fixed; inset:0;
      width:100%; height:100%;
      z-index:0;
      display:block;
      pointer-events:none;
    }
    .overlay{
      position:fixed; inset:0; z-index:1; pointer-events:none;
      background:
        radial-gradient(60% 60% at 50% 40%, rgba(0,0,0,0) 0%, rgba(0,0,0,.62) 70%, rgba(0,0,0,.90) 100%);
    }
    .wrap{position:relative; z-index:2; height:100vh; display:grid; place-items:center; padding:28px;}
    .hero{
      width:min(980px,100%);
      border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      backdrop-filter:blur(10px);
      border-radius:22px;
      padding:clamp(18px,3vw,34px);
      box-shadow:0 30px 120px rgba(0,0,0,.55);
    }
    .pill{
      font-size:12px; padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
      color:rgba(255,255,255,.78);
      display:inline-block; margin-bottom:10px;
    }
    h1{font-size:clamp(28px,4vw,54px);line-height:1.05;letter-spacing:-0.02em;margin-bottom:10px}
    p{color:var(--muted);font-size:clamp(14px,1.4vw,18px);line-height:1.45;max-width:60ch}
  </style>
</head>

<body>
  <canvas id="gas"></canvas>
  <div class="overlay"></div>

  <main class="wrap">
    <section class="hero">
      <span class="pill">Abstract vapor field</span>
      <h1>Airy, gas-like color motion.</h1>
      <p>No ribbons. Just soft, drifting, refractive-feeling vapor with subtle bloom.</p>
    </section>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script>
    const canvas = document.getElementById("gas");
    const ctx = canvas.getContext("2d", { alpha:true });

    // Offscreen low-res buffer for speed (then upscaled)
    const buf = document.createElement("canvas");
    const btx = buf.getContext("2d", { alpha:true });

    const S = {
      w:0, h:0, dpr: Math.max(1, Math.min(2, window.devicePixelRatio || 1)),
      t:0,
      // keep slow
      speed: 0.0038,

      // gas look
      density: 0.90,     // overall opacity
      fade: 0.065,       // trails fade (higher = more fade)
      bloom: 0.55,       // center haze
      swirl: 0.75,       // warping strength
      scale: 0.48,       // buffer resolution scale (0.35..0.6)

      // mouse drift
      mx:0, my:0, px:0, py:0
    };

    function resize(){
      S.w = Math.floor(window.innerWidth);
      S.h = Math.floor(window.innerHeight);

      canvas.width  = Math.floor(S.w * S.dpr);
      canvas.height = Math.floor(S.h * S.dpr);
      canvas.style.width  = S.w + "px";
      canvas.style.height = S.h + "px";
      ctx.setTransform(S.dpr,0,0,S.dpr,0,0);

      // low-res buffer
      buf.width  = Math.floor(S.w * S.scale * S.dpr);
      buf.height = Math.floor(S.h * S.scale * S.dpr);
      btx.setTransform(S.dpr,0,0,S.dpr,0,0);

      // clear buffers
      ctx.fillStyle = "#000"; ctx.fillRect(0,0,S.w,S.h);
      btx.fillStyle = "rgba(0,0,0,1)"; btx.fillRect(0,0,S.w*S.scale, S.h*S.scale);
    }
    window.addEventListener("resize", resize, { passive:true });
    resize();

    window.addEventListener("pointermove", (e)=>{
      S.mx = (e.clientX / S.w) * 2 - 1;
      S.my = (e.clientY / S.h) * 2 - 1;
    }, { passive:true });

    const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));
    const lerp  = (a,b,t)=>a+(b-a)*t;

    // Very simple smooth “value noise” based on sin/cos — fast + organic enough
    function n2(x,y){
      return Math.sin(x*1.7 + Math.cos(y*1.3)) * Math.cos(y*1.5 + Math.sin(x*1.1));
    }

    function fogBlob(x,y,r, colA, colB, a){
      // airy blob using radial gradient with soft edge
      const g = btx.createRadialGradient(x,y,0, x,y,r);
      g.addColorStop(0.0, colA.replace("{a}", (0.0 + 0.55*a).toFixed(4)));
      g.addColorStop(0.45, colB.replace("{a}", (0.0 + 0.30*a).toFixed(4)));
      g.addColorStop(1.0,  colA.replace("{a}", "0"));
      btx.fillStyle = g;
      btx.beginPath();
      btx.arc(x,y,r,0,Math.PI*2);
      btx.fill();
    }

    // Seeds = moving emitters (but not in a line — they orbit + wander)
    const EMITTERS = Array.from({length: 9}, (_,i)=>({
      seed: Math.random()*10,
      phase: i * 0.9,
      r: 0.12 + Math.random()*0.28,
      s: 0.35 + Math.random()*0.55
    }));

    function stepGas(){
      S.t += S.speed;

      // smooth mouse -> gentle drift
      S.px += (S.mx - S.px) * 0.035;
      S.py += (S.my - S.py) * 0.035;

      const W = S.w * S.scale;
      const H = S.h * S.scale;

      // fade previous frame (trails)
      btx.globalCompositeOperation = "source-over";
      btx.fillStyle = `rgba(0,0,0,${S.fade})`;
      btx.fillRect(0,0,W,H);

      // ambient mist (soft, colored)
      const cx = W*0.5 + S.px*20;
      const cy = H*0.5 + S.py*16;
      const R  = Math.hypot(W,H)*0.55;
      const mg = btx.createRadialGradient(cx,cy,0, cx,cy,R);
      mg.addColorStop(0.0, `rgba(255,255,255,${0.020*S.bloom})`);
      mg.addColorStop(0.35, `rgba(120,255,230,${0.018*S.bloom})`);
      mg.addColorStop(0.62, `rgba(200,120,255,${0.012*S.bloom})`);
      mg.addColorStop(1.0, "rgba(0,0,0,0)");
      btx.fillStyle = mg;
      btx.fillRect(0,0,W,H);

      // draw vapor blobs from multiple emitters
      btx.globalCompositeOperation = "lighter";

      for(const e of EMITTERS){
        // organic orbit + wander (not a ribbon)
        const tt = S.t*0.8 + e.seed;
        const ox = Math.cos(tt*0.7 + e.phase) * W*e.r;
        const oy = Math.sin(tt*0.6 + e.phase*1.2) * H*e.r;

        // noise warp position (swirl)
        const wx = n2(tt*0.9, e.phase*2.1);
        const wy = n2(e.phase*1.7, tt*0.8);

        const x = W*0.5 + ox + wx * 34 * S.swirl + S.px*22;
        const y = H*0.5 + oy + wy * 26 * S.swirl + S.py*18;

        // size breath
        const baseR = (42 + 58*Math.sin(tt + e.phase)) * e.s;
        const r = clamp(baseR, 28, 120);

        // color drift over time (variation!)
        const c = (Math.sin(tt*0.45 + e.phase)*0.5 + 0.5);   // 0..1
        const c2= (Math.cos(tt*0.38 - e.phase)*0.5 + 0.5);

        // palette: teal / cyan / violet / pink — but drifting
        const colA = `rgba(${Math.floor(80 + 120*c2)}, ${Math.floor(200 + 40*c)}, 255, {a})`;
        const colB = `rgba(${Math.floor(190 + 40*c)}, ${Math.floor(80 + 80*c2)}, ${Math.floor(255 - 40*c)}, {a})`;

        // airy alpha — never opaque
        const a = (0.10 + 0.10*c) * S.density;

        fogBlob(x, y, r, colA, colB, a);

        // add a second smaller blob offset for “turbulence”
        fogBlob(x + wx*18, y - wy*14, r*0.55, colB, colA, a*0.75);
      }

      btx.globalCompositeOperation = "source-over";

      // final composite: upscale buffer with smoothing + a little bloom illusion
      ctx.globalCompositeOperation = "source-over";

      // clear very lightly (keeps it airy)
      ctx.fillStyle = "rgba(0,0,0,0.12)";
      ctx.fillRect(0,0,S.w,S.h);

      // draw buffer scaled up
      ctx.imageSmoothingEnabled = true;
      ctx.globalAlpha = 1;
      ctx.drawImage(buf, 0, 0, W*S.dpr, H*S.dpr, 0, 0, S.w, S.h);

      // extra “glow” pass (cheap bloom)
      ctx.globalCompositeOperation = "lighter";
      ctx.globalAlpha = 0.35;
      ctx.drawImage(buf, 0, 0, W*S.dpr, H*S.dpr, 0, 0, S.w, S.h);
      ctx.globalAlpha = 1;
      ctx.globalCompositeOperation = "source-over";
    }

    gsap.ticker.fps(60);
    gsap.ticker.add(stepGas);

    // Reduced motion
    if (window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
      gsap.ticker.remove(stepGas);
      // render a still frame
      for(let i=0;i<20;i++) stepGas();
    }
  </script>
</body>
</html>